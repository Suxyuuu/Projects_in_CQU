#根据总特征文件，读取特征文件，返回装有特征向量的列表和特征文件名列表
#输入 【特征名称的txt文件的文件夹路径】，装有【总特征名称的列表】 --> 输出 各apk对应该【特征的向量列表】，各【apk名称列表】

import os
import AndroidMalwaresDetect.GetAllFeatureList as GetAllFeatureList

def getFeatureVector(feature_file_path, all_feature_list):
    
    #存放所有样本集的特征向量
    vector_list=[]

    # 存放良性样本权限的文件夹路径
    file_list = os.listdir(feature_file_path)

    
    for name in file_list:
        # 为每个文件构造初始权限特征向量
        single_permission = []
        
        permission_vector = [0]*len(all_feature_list)
        file = open(feature_file_path+r'\\'+name, 'r')
        # 读取每个文件中的所有权限
        for item in file:
            item = item.strip('\n')
            single_permission.append(item)
        file.close()

        for permission in single_permission:
            if permission in all_feature_list:
                permission_vector[all_feature_list.index(permission)] = 1
            else:
                pass
        vector_list.append(permission_vector)


    return vector_list,file_list




def main():
    feature_file_path=r'D:\apk\apktooltest\permission\good_sample_permission'
    all_feature_file_path=r'D:\apk\all\key_permission.txt'
    all_feature_list=GetAllFeatureList.get_all_feature_list(all_feature_file_path)
    S,file_list=getFeatureVector(feature_file_path,all_feature_list)
    print(len(S[0]))
    print(len(S[1]))

if __name__ == "__main__":
    main()