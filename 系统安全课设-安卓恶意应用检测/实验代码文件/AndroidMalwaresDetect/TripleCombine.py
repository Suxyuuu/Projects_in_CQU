import os
import AndroidMalwaresDetect.DealwithData as DealwithData

def double_combine(good_feature_list1, good_file_list1, bad_feature_list1, bad_file_list1,
            good_feature_list2, good_file_list2, bad_feature_list2, bad_file_list2,
            good_feature_list3, good_file_list3, bad_feature_list3, bad_file_list3):
       
    new_good_feature_list=[]

    for file_name in good_file_list1:
        if file_name in good_file_list2:
            if file_name in good_file_list3:
                feature_index_inlist1=good_file_list1.index(file_name)
                feature_index_inlist2=good_file_list2.index(file_name)
                feature_index_inlist3=good_file_list3.index(file_name)
                list=[]
                list1=good_feature_list1[feature_index_inlist1]
                for i in list1:
                    list.append(i)
                list2=good_feature_list2[feature_index_inlist2]
                for i in list2:
                    list.append(i)
                list3=good_feature_list3[feature_index_inlist3]
                for i in list3:
                    list.append(i)
                new_good_feature_list.append(list)
    
    new_bad_feature_list=[]

    for file_name in bad_file_list1:
        if file_name in bad_file_list2: 
            if file_name in bad_file_list3:
                feature_index_inlist1=bad_file_list1.index(file_name)
                feature_index_inlist2=bad_file_list2.index(file_name)
                feature_index_inlist3=bad_file_list3.index(file_name)
                list=[]
                list1=bad_feature_list1[feature_index_inlist1]
                for i in list1:
                    list.append(i)
                list2=bad_feature_list2[feature_index_inlist2]
                for i in list2:
                    list.append(i)
                list3=bad_feature_list3[feature_index_inlist3]
                for i in list3:
                    list.append(i)
                new_bad_feature_list.append(list)

    return new_good_feature_list,new_bad_feature_list


def main():
    #字节码向量文件路径
    file_one_path=r'D:\apk\byte\bad_sample_dalvik_count_vector'
    file_two_path=r'D:\apk\byte\good_sample_dalvik_count_vector'
    #权限向量文件路径
    file_three_path=r'D:\apk\apktooltest\permission\trainandtest_good_permission'
    file_four_path=r'D:\apk\apktooltest\permission\trainandtest_bad_permission'

    good_vector_list_1=DealwithData.getvectorfromfile(file_two_path)
    good_file_list_1=os.listdir(file_two_path)
    bad_vector_list_1=DealwithData.getvectorfromfile(file_one_path)
    bad_file_list_1=os.listdir(file_one_path)

    good_vector_list_2=DealwithData.getvectorfromfile(file_three_path)
    good_file_list_2=os.listdir(file_three_path)
    bad_vector_list_2=DealwithData.getvectorfromfile(file_four_path)
    bad_file_list_2=os.listdir(file_four_path)


if __name__ == "__main__":
    main()