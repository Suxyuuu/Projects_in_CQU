import AndroidMalwaresDetect.getSmali as getSmali
import AndroidMalwaresDetect.GetFeatureVector as GetFeatureVector
import AndroidMalwaresDetect.GetTrainList as GetTrainList
import AndroidMalwaresDetect.TestByMachineLearning as ml
import AndroidMalwaresDetect.DealwithData as DealwithData
import os
import AndroidMalwaresDetect.Combine as Combine
import AndroidMalwaresDetect.TripleCombine as TripleCombine

#字节码向量文件路径（未归一）
file_one_path=r'D:\apk\features\byte\bad_sample_dalvik_count_vector'
file_two_path=r'D:\apk\features\byte\good_sample_dalvik_count_vector'
#权限向量文件路径
file_three_path=r'D:\apk\features\permission\trainandtest_good_permission'
file_four_path=r'D:\apk\features\permission\trainandtest_bad_permission'
#api向量文件路径
file_five_path=r'D:\apk\features\api\good'
file_six_path=r'D:\apk\features\api\bad'
#字节码向量文件路径（归一）
file_seven_path=r'D:\apk\features\byte\good_sample_dalvik_count_average_normalGua'
file_eight_path=r'D:\apk\features\byte\bad_sample_dalvik_count_average_normalGua'

#字节码向量（未归一）
good_vector_list_1=DealwithData.getvectorfromfile(file_two_path)
good_file_list_1=os.listdir(file_two_path)
bad_vector_list_1=DealwithData.getvectorfromfile(file_one_path)
bad_file_list_1=os.listdir(file_one_path)

#权限向量
good_vector_list_2=DealwithData.getvectorfromfile(file_three_path)
good_file_list_2=os.listdir(file_three_path)
bad_vector_list_2=DealwithData.getvectorfromfile(file_four_path)
bad_file_list_2=os.listdir(file_four_path)

#api向量
good_vector_list_3=DealwithData.getvectorfromfile(file_five_path)
good_file_list_3=os.listdir(file_five_path)
bad_vector_list_3=DealwithData.getvectorfromfile(file_six_path)
bad_file_list_3=os.listdir(file_six_path)

#字节码向量（未归一）
good_vector_list_4=DealwithData.getvectorfromfile(file_seven_path)
good_file_list_4=os.listdir(file_seven_path)
bad_vector_list_4=DealwithData.getvectorfromfile(file_eight_path)
bad_file_list_4=os.listdir(file_eight_path)




#字节码(未归一)+权限
good_1,bad_1=Combine.combine(good_vector_list_1,good_file_list_1,bad_vector_list_1,bad_file_list_1,
                            good_vector_list_2,good_file_list_2,bad_vector_list_2,bad_file_list_2)

#字节码(未归一)+api
good_2,bad_2=Combine.combine(good_vector_list_1,good_file_list_1,bad_vector_list_1,bad_file_list_1,
                            good_vector_list_3,good_file_list_3,bad_vector_list_3,bad_file_list_3)

#api+权限
good_3,bad_3=Combine.combine(good_vector_list_3,good_file_list_3,bad_vector_list_3,bad_file_list_3,
                            good_vector_list_2,good_file_list_2,bad_vector_list_2,bad_file_list_2)

#字节码(未归一)+权限+api

good_4,bad_4=TripleCombine.double_combine(good_vector_list_1,good_file_list_1,bad_vector_list_1,bad_file_list_1,
                                        good_vector_list_2,good_file_list_2,bad_vector_list_2,bad_file_list_2,
                                        good_vector_list_3,good_file_list_3,bad_vector_list_3,bad_file_list_3)

#字节码(归一)+权限
good_5,bad_5=Combine.combine(good_vector_list_4,good_file_list_4,bad_vector_list_4,bad_file_list_4,
                            good_vector_list_2,good_file_list_2,bad_vector_list_2,bad_file_list_2)


#字节码(归一)+api
good_6,bad_6=Combine.combine(good_vector_list_4,good_file_list_4,bad_vector_list_4,bad_file_list_4,
                            good_vector_list_3,good_file_list_3,bad_vector_list_3,bad_file_list_3)

#字节码(归一)+权限+api

good_7,bad_7=TripleCombine.double_combine(good_vector_list_4,good_file_list_4,bad_vector_list_4,bad_file_list_4,
                                        good_vector_list_2,good_file_list_2,bad_vector_list_2,bad_file_list_2,
                                        good_vector_list_3,good_file_list_3,bad_vector_list_3,bad_file_list_3)

'''
print("字节码（未归一）+权限")
ml.naviebayes_B(good_1,bad_1)
ml.naviebayes_M(good_1,bad_1)
ml.naviebayes_G(good_2,bad_2)

ml.randomforest(good_1,bad_1)
ml.decisiontree(good_1,bad_1)
ml.SVM(good_1,bad_1)
'''
'''
print("字节码（未归一）+api")
ml.naviebayes_B(good_2,bad_2)
ml.naviebayes_M(good_2,bad_2)
ml.naviebayes_G(good_2,bad_2)

ml.randomforest(good_2,bad_2)
ml.decisiontree(good_2,bad_2)
ml.SVM(good_2,bad_2)
'''
'''
print("api+权限")
ml.naviebayes_B(good_3,bad_3)
ml.naviebayes_M(good_3,bad_3)
ml.naviebayes_G(good_3,bad_3)

ml.randomforest(good_3,bad_3)
ml.decisiontree(good_3,bad_3)
ml.SVM(good_3,bad_3)
'''

print("api+权限+字节码（未归一）")
ml.naviebayes_B(good_4,bad_4)
ml.naviebayes_M(good_4,bad_4)
ml.naviebayes_G(good_4,bad_4)
'''
ml.randomforest(good_4,bad_4)
ml.decisiontree(good_4,bad_4)
ml.SVM(good_4,bad_4)
'''

print("字节码（归一）+权限")
ml.naviebayes_B(good_5,bad_5)
#ml.naviebayes_M(good_5,bad_5)
ml.naviebayes_G(good_5,bad_5)
'''
ml.randomforest(good_5,bad_5)
ml.decisiontree(good_5,bad_5)
ml.SVM(good_5,bad_5)
'''

print("字节码（归一）+api")
ml.naviebayes_B(good_6,bad_6)
#ml.naviebayes_M(good_6,bad_6)
ml.naviebayes_G(good_6,bad_6)
'''
ml.randomforest(good_6,bad_6)
ml.decisiontree(good_6,bad_6)
ml.SVM(good_6,bad_6)
'''

print("api+权限+字节码（归一）")
ml.naviebayes_B(good_7,bad_7)
#ml.naviebayes_M(good_7,bad_7)
ml.naviebayes_G(good_7,bad_7)
'''
ml.randomforest(good_7,bad_7)
ml.decisiontree(good_7,bad_7)
ml.SVM(good_7,bad_7)
'''

